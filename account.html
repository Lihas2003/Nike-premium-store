<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NIKE | My Account</title>
    <link rel="stylesheet" href="style.css">
</head>
<body class="account-body">
    <div class="background-glow"></div>
    
    <div class="user-nav">
        <a href="index.html">‚Üê BACK TO SHOP</a>
    </div>

    <div class="account-container">
        <div class="profile-section">
            <div class="profile-pic-box" id="profile-pic-container">
                <span style="font-size: 4rem; color: #555;">üë§</span>
            </div>
            <div class="profile-info">
                <h2 id="user-greeting">Welcome</h2>
                <input type="file" id="file-upload" hidden accept="image/*">
                <button class="upload-btn" onclick="document.getElementById('file-upload').click()">Change Picture</button>
            </div>
        </div>

        <div class="orders-section">
            <h3>YOUR ORDER HISTORY</h3>
            <div id="order-list" class="order-list">
                <p style="color: #999;">Loading orders...</p>
            </div>
        </div>
        
        <button class="logout-btn" onclick="logout()">LOG OUT</button>
    </div>

    <script>
        // ACCOUNT PAGE LOGIC
        document.addEventListener('DOMContentLoaded', () => {
            // 1. Check Login
            if (localStorage.getItem('isLoggedIn') !== 'true') {
                window.location.href = 'auth.html';
                return;
            }

            // 2. Load Name
            const userName = localStorage.getItem('userName') || 'Customer';
            document.getElementById('user-greeting').innerText = `Welcome, ${userName}`;

            // 3. Load Profile Pic
            const savedImage = localStorage.getItem('profileImage');
            if (savedImage) {
                const container = document.getElementById('profile-pic-container');
                container.innerHTML = `<img src="${savedImage}" style="width:100%; height:100%; object-fit:cover;">`;
            }

            // 4. Handle Picture Upload
            document.getElementById('file-upload').addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        const imgData = event.target.result;
                        const container = document.getElementById('profile-pic-container');
                        container.innerHTML = `<img src="${imgData}" style="width:100%; height:100%; object-fit:cover;">`;
                        localStorage.setItem('profileImage', imgData);
                    };
                    reader.readAsDataURL(file);
                }
            });

            // 5. Load History
            loadHistory();
        });

        function loadHistory() {
            const orders = JSON.parse(localStorage.getItem('orders')) || [];
            const list = document.getElementById('order-list');
            list.innerHTML = '';

            if (orders.length === 0) {
                list.innerHTML = '<p style="color: #999;">No orders placed yet.</p>';
                return;
            }

            orders.forEach(order => {
                const item = document.createElement('div');
                item.className = 'order-item';
                item.innerHTML = `
                    <div class="order-header">
                        <span>${order.date}</span>
                        <span style="color: #00ff88; font-weight: bold;">${order.price}</span>
                    </div>
                    <div style="color: #ccc; margin-top: 5px;">
                        <strong>${order.shoeName}</strong> <br>
                        Size: ${order.size} <br>
                        <span style="font-size: 0.85rem; color: #888;">To: ${order.address}</span>
                    </div>
                `;
                list.appendChild(item);
            });
        }

        function logout() {
            localStorage.removeItem('isLoggedIn');
            window.location.href = 'index.html';
        }
    </script>
</body>
</html>